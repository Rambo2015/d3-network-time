<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Add a geocoder</title>
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="../build/d3-network-time.js"></script>
  <style>
    body { margin: 0; padding: 0; }
  </style>
</head>
<body>
  <div class="Network"></div>
  <script>

    async function init() {

      const data = await d3.json('miserables.json');

      const processedLinks = processLinks(data.links)
      const processedNodes = processNodes(data.nodes, data.links)
      const data1 = {nodes: processedNodes, links: processedLinks}

      d3.network('.Network')
        .width(screen.width)
        .height(screen.height)
        .start('2020-05-01')
        .end('2020-05-03')
        .style('auto')(data1)

    }

    function processLinks(links) {

      links.forEach((d,i) => {
        d.id = i
        d.start_id = d.source.toString()
        d.end_id = d.target.toString()
        d.label = 'Related'
      })

      return links
    }

    function processNodes(nodes, links, rootID=null) {

      nodes.forEach((d,i) => {
        d.id = d.id.toString()
        if(d.id.toString() === rootID){
          d.root = 'root'
        }
      })

      return nodes
    }

    init()
  </script>
</body>
</html>